<!DOCTYPE html> <html lang=" en "><head> <meta charset="utf-8" /> <title> Build a Blog using Nodejs - Part 3 Add New Posts -hack4r </> </title> <meta http-equip="X-UA-Compatible" content="IE=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1" /> <meta name="description" content="Learn how to build a Blog App using Nodejs- Build a Blog using Nodejs - Part 3 Add New Posts"> <meta name="keywords" content="Build a Blog using Nodejs - Part 3 Add New Posts, hack4r </>, nodejs, express,nodejs, express, create server, node blog"/> <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" /> <meta content="" property="fb:app_id" /> <meta content="hack4r </>" property="og:site_name" /> <meta content="Build a Blog using Nodejs - Part 3 Add New Posts" property="og:title" /> <meta content="article" property="og:type" /> <meta content="Learn how to build a Blog App using Nodejs" property="og:description" /> <meta content="/blog/build-a-blog-using-nodejs-part-3/" property="og:url" /> <meta content="2021-02-07T09:05:23+00:00" property="article:published_time" /> <meta content="/about/" property="article:author" /> <meta content="/assets/img/posts/code.jpg" property="og:image" /> <meta content="nodejs" property="article:section" /> <!-- Twitter Cards --> <meta name="twitter:card" content="summary" /> <meta name="twitter:site" content="@" /> <meta name="twitter:creator" content="@" /> <meta name="twitter:title" content="Build a Blog using Nodejs - Part 3 Add New Posts" /> <meta name="twitter:url" content="/blog/build-a-blog-using-nodejs-part-3/" /> <meta name="twitter:description" content="Learn how to build a Blog App using Nodejs" /> <link rel="stylesheet" href="/assets/css/main.css" /> <!-- <link rel="stylesheet" href="/assets/css/custom-style.css" /> --> <link rel="stylesheet" href="/assets/bower_components/lightgallery/dist/css/lightgallery.min.css" /> <link rel="stylesheet" href="/assets/bower_components/bootstrap/dist/css/bootstrap.min.css" /> <link rel="stylesheet" href="/assets/bower_components/font-awesome/web-fonts-with-css/css/fontawesome-all.min.css" /> <link rel="stylesheet" href="/assets/bower_components/icono/dist/icono.min.css" /> <!-- Fonts--> <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet" /> <!-- Favicon --> <link rel="icon" href="/assets/img/favicon.ico" type="image/gif" sizes="16x16" /> <script> var base_url = '' ; </script> <!-- Jquery --> <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha384-vk5WoKIaW/vJyUAd9n/wmopsmNhiy+L2Z+SBxGYnUkunIxVxAv/UtMOhba/xskxh" crossorigin="anonymous" ></script> <!-- <script src="/assets/bower_components/jquery/dist/jquery.min.js"></script> --> <script src="/assets/bower_components/jquery.easing/jquery.easing.min.js"></script> <script src="/assets/bower_components/bootstrap/dist/js/bootstrap.bundle.min.js"></script> <script src="/assets/bower_components/jquery-mousewheel/jquery.mousewheel.min.js"></script> <script src="/assets/bower_components/ghosthunter/dist/jquery.ghostHunter.min.js"></script> <script src="/assets/bower_components/lightgallery/dist/js/lightgallery-all.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/picturefill/3.0.2/picturefill.min.js"></script> <script src="/assets/bower_components/imagesloaded/imagesloaded.pkgd.min.js"></script> <script src="/assets/bower_components/nanobar/nanobar.min.js"></script> <script src="/assets/bower_components/typewrite/dist/typewrite.min.js"></script> <script src="/assets/js/search.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script> <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script> <!-- for Mathjax support --> <!-- Github Button --> <script async defer src="https://buttons.github.io/buttons.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous" ></script> <!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--> <!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]--> <!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]--> <!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]--> </head> <body> <nav class="navbar navbar-expand-lg fixed-top navbar-dark" id="topNav"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation" > <span class="icono-hamburger" id="navbar-hamburger"> </span> </button> <a class="navbar-brand" href="https://hack4r.com">hack4r </></a> <div class="collapse navbar-collapse" id="navbarNav"> <ul class="navbar-nav"> <li class="nav-item"> <a class="nav-link" href="/" >Home</a > </li> <li class="nav-item"> <a class="nav-link" href="/blog" >Blog</a > </li> </ul> </div> <ul class="nav justify-content-end"> <li class="nav-item"> <a class="nav-link toggle-search-button" href="#search"> <i class="fa fa-search search-icon" aria-hidden="true"></i> </a> </li> <!-- <li class="nav-item"> <input class="nav-link switch" id="theme-toggle" onclick="modeSwitcher() " type="checkbox" name="checkbox" /> </li> --> </ul> </nav> <!-- Search Form --> <div class="search-form-container"> <form class="search-form"> <fieldset class="search-form__fieldset"> <div class="row"> <div class="col-lg-8 offset-md-2"> <input class="search-form__field" placeholder="Type to Search..." autofocus> <input class="search-form__submit" type="submit" value="search"> </div> </div> </fieldset> </form> <div class="row"> <div class="col-lg-8 offset-md-2 search-results"> <div class="card search-results"></div> </div> </div> <div class="close-search-button search-form-container__close"> <i class="fa fa-times icon"></i> </div> </div><div class="col-lg-12"> <div class="row" id="blog-post-container"> <div class="col-lg-8 offset-md-2"><article class="card" itemscope itemtype="http://schema.org/BlogPosting"> <div class="card-header"> <h1 class="post-title" itemprop="name headline">Build a Blog using Nodejs - Part 3 Add New Posts</h1> <h4 class="post-meta">Learn how to build a Blog App using Nodejs</h4> <p class="post-summary"> Posted by : <span itemprop="author" itemscope itemtype="http://schema.org/Person"> <span itemprop="name"><a href="/blog/authors/xplor4r">xplor4r</a></span> </span > at <time datetime="2021-02-07 09:05:23 +0000" itemprop="datePublished" >Feb 7, 2021</time > </p> <span class="disqus-comment-count" data-disqus-identifier="/blog/build-a-blog-using-nodejs-part-3/" ></span> <div class="post-categories"> Category : <a href="/blog/categories/nodejs" >nodejs</a > &nbsp; <a href="/blog/categories/express" >express</a > </div> </div> <div class="card-body" itemprop="articleBody"> <img class="card-img-top" src="/assets/img/posts/code.jpg" alt="" /> <br /> <br /> <p>In this article, we will see how to create blog posts :</p> <p>Lets create a route for creating posts :</p> <p>We will create a /add-post route</p> <p>add-post.ejs</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;html&gt;</span>
    <span class="nt">&lt;head&gt;</span>
        <span class="nt">&lt;title&gt;</span> Add Blog Post - Node Blog<span class="nt">&lt;/title&gt;</span>

        <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"assets/css/style.css"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/head&gt;</span>
    <span class="nt">&lt;body&gt;</span>
        <span class="nt">&lt;ul&gt;</span>
            <span class="nt">&lt;li&gt;</span>
                <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/"</span><span class="nt">&gt;</span>Home<span class="nt">&lt;/a&gt;</span>
            <span class="nt">&lt;/li&gt;</span>
            <span class="nt">&lt;li&gt;</span>
                <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/blog"</span><span class="nt">&gt;</span>Blog<span class="nt">&lt;/a&gt;</span>
            <span class="nt">&lt;/li&gt;</span>
            <span class="nt">&lt;li&gt;</span>
                <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/about"</span><span class="nt">&gt;</span>About<span class="nt">&lt;/a&gt;</span>
            <span class="nt">&lt;/li&gt;</span>
            <span class="nt">&lt;li&gt;</span>
                <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/contact"</span><span class="nt">&gt;</span>Contact<span class="nt">&lt;/a&gt;</span>
            <span class="nt">&lt;/li&gt;</span>
            <span class="nt">&lt;li&gt;</span>
                <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/add-post"</span><span class="nt">&gt;</span> Add Post<span class="nt">&lt;/a&gt;</span>
            <span class="nt">&lt;/li&gt;</span>
        <span class="nt">&lt;/ul&gt;</span>
        <span class="nt">&lt;h1&gt;</span> Blog - Add Blog Post <span class="nt">&lt;/h1&gt;</span>

        <span class="nt">&lt;p&gt;</span>Add Blog Post<span class="nt">&lt;/p&gt;</span>

        <span class="nt">&lt;h3&gt;</span>Create a blog post<span class="nt">&lt;/h3&gt;</span>
        <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/create-post"</span> <span class="na">method=</span><span class="s">"POST"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;fieldset&gt;</span>
                <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"posttitle"</span><span class="nt">&gt;</span>Title :<span class="nt">&lt;/label&gt;</span>
                <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"posttitle"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/fieldset&gt;</span>
            <span class="nt">&lt;fieldset&gt;</span>
                <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"postsummary"</span><span class="nt">&gt;</span> Summary :<span class="nt">&lt;/label&gt;</span>
                <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"summary"</span> <span class="na">name=</span><span class="s">"postsummary"</span> <span class="nt">/&gt;</span>
             <span class="nt">&lt;/fieldset&gt;</span>
             <span class="nt">&lt;fieldset&gt;</span>
                <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"postcontent"</span><span class="nt">&gt;</span> Content : <span class="nt">&lt;/label&gt;</span>
                <span class="nt">&lt;textarea</span> <span class="na">name=</span><span class="s">"postcontent"</span> <span class="na">rows=</span><span class="s">"10"</span> <span class="na">cols=</span><span class="s">"14"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;/textarea&gt;</span>
             <span class="nt">&lt;/fieldset&gt;</span>
             <span class="nt">&lt;fieldset&gt;</span>
                <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"postauthor"</span><span class="nt">&gt;</span> Author : <span class="nt">&lt;/label&gt;</span>
                <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"postauthor"</span><span class="nt">&gt;</span>
             <span class="nt">&lt;/fieldset&gt;</span>
            <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span><span class="nt">&gt;</span>Send<span class="nt">&lt;/button&gt;</span>
        <span class="nt">&lt;/form&gt;</span>

    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>

</code></pre></div></div> <p>The /create-post will be our api endpoint to capture the form data. Since it will be in ‘application/x-www-form-urlencoded’ format, we need to parse the data to represent as json and then save it in our postsLists.json (posts file)</p> <p>We will create a handler function for collecting this data from the form</p> <p>Lets create a src/handler.js</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">querystring</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">querystring</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">function</span> <span class="nx">collectRequestData</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">FORM_URLENCODED</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">application/x-www-form-urlencoded</span><span class="dl">'</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">headers</span><span class="p">[</span><span class="dl">'</span><span class="s1">content-type</span><span class="dl">'</span><span class="p">]</span> <span class="o">===</span> <span class="nx">FORM_URLENCODED</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">body</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>
        <span class="nx">request</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">data</span><span class="dl">'</span><span class="p">,</span> <span class="nx">chunk</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="nx">body</span> <span class="o">+=</span> <span class="nx">chunk</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span>
        <span class="p">});</span>
        <span class="nx">request</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">end</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="nx">callback</span><span class="p">(</span><span class="nx">querystring</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">body</span><span class="p">));</span>
        <span class="p">});</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">callback</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">collectFormData</span> <span class="o">=</span> <span class="nx">collectRequestData</span><span class="p">;</span>
<span class="c1">//exports.someMethod = function() {}</span>
</code></pre></div></div> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">http</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">http</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">fs</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">ejs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">ejs</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">path</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">hostname</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">127.0.0.1</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">port</span> <span class="o">=</span> <span class="mi">3000</span><span class="p">;</span>

<span class="kd">const</span> <span class="p">{</span><span class="nx">collectFormData</span><span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">./src/handlers</span><span class="dl">'</span><span class="p">);</span>

<span class="c1">// data for posts</span>
<span class="kd">const</span> <span class="nx">blogPosts</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">./posts/postsLists.json</span><span class="dl">'</span><span class="p">);</span>


<span class="kd">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>

    <span class="c1">// check the type of request</span>
    <span class="kd">let</span> <span class="nx">endpoint</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">url</span><span class="p">;</span>
    <span class="kd">let</span> <span class="nx">method</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">method</span><span class="p">;</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Server Hit :</span><span class="dl">'</span><span class="p">,</span> <span class="nx">endpoint</span><span class="p">);</span>

    <span class="c1">// submit post</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">endpoint</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">/create-post</span><span class="dl">'</span> <span class="o">&amp;&amp;</span> <span class="nx">method</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">POST</span><span class="dl">'</span><span class="p">){</span>
        <span class="nx">collectFormData</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">result</span> <span class="o">=&gt;</span> <span class="p">{</span>

            <span class="c1">// res.end(`Parsed data ${result.posttitle}`)</span>
           <span class="kd">let</span> <span class="nx">resultObj</span> <span class="o">=</span> <span class="p">{</span>
               <span class="dl">'</span><span class="s1">title</span><span class="dl">'</span><span class="p">:</span> <span class="nx">result</span><span class="p">.</span><span class="nx">posttitle</span><span class="p">,</span>
               <span class="dl">'</span><span class="s1">excerpt</span><span class="dl">'</span><span class="p">:</span><span class="nx">result</span><span class="p">.</span><span class="nx">postsummary</span><span class="p">,</span>
               <span class="dl">'</span><span class="s1">description</span><span class="dl">'</span><span class="p">:</span> <span class="nx">result</span><span class="p">.</span><span class="nx">postcontent</span><span class="p">,</span>
               <span class="dl">'</span><span class="s1">author</span><span class="dl">'</span><span class="p">:</span> <span class="nx">result</span><span class="p">.</span><span class="nx">postauthor</span>
           <span class="p">}</span>

           <span class="c1">// read the file</span>
           <span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="dl">'</span><span class="s1">./posts/postsLists.json</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="kd">let</span> <span class="nx">fetchedData</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
                <span class="kd">let</span> <span class="nx">postId</span> <span class="o">=</span> <span class="nx">fetchedData</span><span class="p">.</span><span class="nx">length</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
                <span class="nx">resultObj</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="nx">postId</span><span class="p">;</span>

                <span class="nx">fetchedData</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">resultObj</span><span class="p">);</span> <span class="c1">//since its array of json Objects</span>
                <span class="nx">resultObj</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">fetchedData</span><span class="p">);</span>

                <span class="c1">//append to the file</span>
                <span class="nx">fs</span><span class="p">.</span><span class="nx">writeFileSync</span><span class="p">(</span><span class="dl">'</span><span class="s1">./posts/postsLists.json</span><span class="dl">'</span><span class="p">,</span> <span class="nx">resultObj</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">){</span>
                      <span class="k">throw</span> <span class="nx">err</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">The "data to append" was appended to file!</span><span class="dl">'</span><span class="p">);</span>
                <span class="p">});</span>
           <span class="p">});</span>


           <span class="c1">// redirect</span>
           <span class="nx">res</span><span class="p">.</span><span class="nx">statusCode</span> <span class="o">=</span> <span class="mi">302</span><span class="p">;</span>
           <span class="nx">res</span><span class="p">.</span><span class="nx">setHeader</span><span class="p">(</span><span class="dl">'</span><span class="s1">Location</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">/blog</span><span class="dl">'</span><span class="p">);</span>
           <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="dl">'</span><span class="s1">OK</span><span class="dl">'</span><span class="p">);</span>
        <span class="p">})</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="kd">let</span> <span class="nx">routePath</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">.</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">endpoint</span><span class="p">;</span>

        <span class="k">if</span><span class="p">(</span><span class="nx">routePath</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">./</span><span class="dl">'</span><span class="p">){</span>
            <span class="nx">routePath</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">./index.ejs</span><span class="dl">'</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">routePath</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">./blog</span><span class="dl">'</span><span class="p">){</span>
            <span class="nx">routePath</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">./blog.ejs</span><span class="dl">'</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">routePath</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">./add-post</span><span class="dl">'</span><span class="p">){</span>
            <span class="nx">routePath</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">./add-post.ejs</span><span class="dl">'</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">routePath</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">./about</span><span class="dl">'</span><span class="p">){</span>
            <span class="nx">routePath</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">./about.html</span><span class="dl">'</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">routePath</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">./contact</span><span class="dl">'</span><span class="p">){</span>
            <span class="nx">routePath</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">./contact.html</span><span class="dl">'</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">routePath</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">./api/posts</span><span class="dl">'</span><span class="p">){</span>
            <span class="nx">routePath</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">./blog/postsLists.json</span><span class="dl">'</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="kd">let</span> <span class="nx">extname</span> <span class="o">=</span> <span class="nb">String</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">extname</span><span class="p">(</span><span class="nx">routePath</span><span class="p">)).</span><span class="nx">toLowerCase</span><span class="p">();</span>
        <span class="kd">const</span> <span class="nx">mimeTypes</span> <span class="o">=</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">.html</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">text/html</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">.js</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">text/javascript</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">.ejs</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/javascript</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">.css</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">text/css</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">.json</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">.png</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">image/png</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">.jpg</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">image/jpg</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">.gif</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">image/gif</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">.svg</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">image/svg+xml</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">.wav</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">audio/wav</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">.mp4</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">video/mp4</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">.woff</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/font-woff</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">.ttf</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/font-ttf</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">.eot</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/vnd.ms-fontobject</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">.otf</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/font-otf</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">.wasm</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/wasm</span><span class="dl">'</span>
        <span class="p">};</span>

        <span class="kd">let</span> <span class="nx">contentType</span> <span class="o">=</span> <span class="nx">mimeTypes</span><span class="p">[</span><span class="nx">extname</span><span class="p">]</span> <span class="o">||</span> <span class="dl">'</span><span class="s1">application/octet-stream</span><span class="dl">'</span><span class="p">;</span>

        <span class="c1">// read the content and return accordingly</span>
        <span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="nx">routePath</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">content</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="c1">// if error occurs, throw 404 or throw error message</span>
            <span class="k">if</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>

                <span class="c1">// IF RESOURCE NOT FOUND</span>
                <span class="k">if</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">code</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">ENOENT</span><span class="dl">'</span><span class="p">){</span>
                    <span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="dl">'</span><span class="s1">./404.html</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">content</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
                        <span class="nx">res</span><span class="p">.</span><span class="nx">statusCode</span> <span class="o">=</span> <span class="mi">404</span><span class="p">;</span>
                        <span class="nx">res</span><span class="p">.</span><span class="nx">setHeader</span><span class="p">(</span><span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">text/html</span><span class="dl">'</span><span class="p">);</span>
                        <span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="nx">content</span><span class="p">,</span> <span class="dl">'</span><span class="s1">utf-8</span><span class="dl">'</span><span class="p">);</span>
                    <span class="p">});</span>
                <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                    <span class="nx">res</span><span class="p">.</span><span class="nx">writeHead</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
                    <span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="dl">'</span><span class="s1">Sorry, something went wrong. Please contact the admin for error</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">err</span><span class="p">.</span><span class="nx">code</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">..</span><span class="se">\n</span><span class="dl">'</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span><span class="k">else</span><span class="p">{</span>

                <span class="c1">// if no error occurs, return the content based on the content-type</span>
                <span class="nx">res</span><span class="p">.</span><span class="nx">statusCode</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span>

                <span class="c1">// if templates are called (ejs rendered pages)</span>
                <span class="k">if</span><span class="p">(</span><span class="nx">contentType</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">application/javascript</span><span class="dl">"</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="kd">let</span> <span class="nx">htmlContent</span> <span class="o">=</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="nx">routePath</span><span class="p">,</span> <span class="dl">'</span><span class="s1">utf8</span><span class="dl">'</span><span class="p">);</span>
                    <span class="kd">let</span> <span class="nx">htmlRendered</span><span class="p">;</span>

                    <span class="k">if</span><span class="p">(</span><span class="nx">endpoint</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">/blog</span><span class="dl">'</span><span class="p">){</span>
                        <span class="nx">htmlRendered</span> <span class="o">=</span> <span class="nx">ejs</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="nx">htmlContent</span><span class="p">,</span> <span class="p">{</span><span class="na">posts</span><span class="p">:</span> <span class="nx">blogPosts</span> <span class="p">});</span>
                    <span class="p">}</span>
                    <span class="k">else</span><span class="p">{</span>
                        <span class="nx">htmlRendered</span> <span class="o">=</span> <span class="nx">ejs</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="nx">htmlContent</span><span class="p">);</span>
                    <span class="p">}</span>

                    <span class="nx">res</span><span class="p">.</span><span class="nx">setHeader</span><span class="p">(</span><span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">text/html</span><span class="dl">'</span><span class="p">);</span>
                    <span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="nx">htmlRendered</span><span class="p">,</span> <span class="dl">'</span><span class="s1">utf-8</span><span class="dl">'</span><span class="p">);</span>
                <span class="p">}</span><span class="k">else</span><span class="p">{</span>

                    <span class="c1">// if no ejs or normal asset files</span>
                    <span class="nx">res</span><span class="p">.</span><span class="nx">setHeader</span><span class="p">(</span><span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">,</span><span class="nx">contentType</span><span class="p">);</span>
                    <span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="nx">content</span><span class="p">,</span> <span class="dl">'</span><span class="s1">utf-8</span><span class="dl">'</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">});</span>
     <span class="p">};</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">server</span> <span class="o">=</span> <span class="nx">http</span><span class="p">.</span><span class="nx">createServer</span><span class="p">(</span><span class="nx">app</span><span class="p">);</span>

<span class="nx">server</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="nx">port</span><span class="p">,</span> <span class="nx">hostname</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Server running at http://</span><span class="p">${</span><span class="nx">hostname</span><span class="p">}</span><span class="s2">:</span><span class="p">${</span><span class="nx">port</span><span class="p">}</span><span class="s2">/`</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div></div> <p>In our posts “/posts/postsLists.json”, we can see the posts generated whenever we create a post.</p> <p>In the next article we will check how to enhance our blog further.</p> <br /><!-- Load Facebook SDK for JavaScript --> <div id="fb-root"></div> <script> (function(d, s, id) { var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) return; js = d.createElement(s); js.id = id; js.src = "https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.0"; fjs.parentNode.insertBefore(js, fjs); })(document, "script", "facebook-jssdk"); </script> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8" ></script> <div class="share-page"> <p class="share-text">Share this on &rarr;</p> <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-size="large" data-show-count="false" style="margin-top:5px;" >Tweet</a > <a class="fb-share-button" data-href="/blog/build-a-blog-using-nodejs-part-3/" data-size="large" data-layout="button" >Share</a> </div><!-- Author box --> <div class="card"> <div class="card-header"> About Sujay kundu </div> <div class="card-body"> <div class="row"> <div class="col-md-4"> <img class="author-profile-img" src="/assets/img/authors/xplor4r.png" alt="Sujay kundu" /> </div> <div class="col-md-6"> <p class="author_bio">Full Stack Web Developer, based in Bangalore, India</p> <p>Email : mail@sujaykundu.com</p> <p>Website : https://sujaykundu.com</p> <p class="profile-links"> <a class="social-link" href="https://github.com/sujaykundu777" target="_blank"><i class="fab fa-github fa-fw"></i></a> <a class="social-link" href="https://www.linkedin.com/in/sujaykundu" target="_blank"><i class="fab fa-linkedin fa-fw"></i></a> <a class="social-link" href="https://www.youtube.com/channel/UCSfLBFFfNU9r6ihfei6VeJw" target="_blank"><i class="fab fa-youtube fa-fw"></i></a> <a class="social-link" href="https://www.facebook.com/sujay.kundu2" target="_blank"><i class="fab fa-facebook fa-fw"></i></a> </p> </div> </div> </div> </div> </div><div class="comments"><!-- Hyvor Comments. For more info visit https://talk.hyvor.com --> <div id="hyvor-talk-view"></div> <script type="text/javascript"> var HYVOR_TALK_WEBSITE = '476'; var HYVOR_TALK_CONFIG = { url: '/blog/build-a-blog-using-nodejs-part-3/', id: '/blog/nodejs-blog-admin-part-3', palette: { accent: "#EB8E3F", accentText: "#080808", footerHeader: "#171616", footerHeaderText: "#656363", box: "#3A3A38", boxText: "#E0E0E0", boxLightText: "#AAAAAA", backgroundText: "#E0E0E0" } }; </script> <script async type="text/javascript" src="//talk.hyvor.com/web-api/embed"></script> </div><!-- Incomment incase you want to use Disqus <div id="disqus_thread"></div> --> </article> <script> var disqus_config = function () { this.page.url = "/blog/build-a-blog-using-nodejs-part-3/"; /* Replace PAGE_URL with your page's canonical URL variable */ this.page.identifier = "/blog/nodejs-blog-admin-part-3"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */ }; (function () { /* DON'T EDIT BELOW THIS LINE */ var d = document, s = d.createElement('script'); s.src = 'https://.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a> </noscript></div> </div> <div class="row"> <div class="col-md-4"> <div class="card"> <div class="card-header">About hack4r</div> <div class="card-body"> <p class="author_bio">A Platform built for Web Developers and Security Enthusiasts</p><!-- Place this tag where you want the github button to render. --> <a class="github-button" href="https://github.com/sujaykundu777/devlopr-jekyll" data-color-scheme="no-preference: dark; light: dark; dark: dark;" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star sujaykundu777/devlopr-jekyll on GitHub">Star</a> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Categories</div> <div class="card-body text-dark"> <div id="#jekyll"></div> <li class="tag-head"> <a href="/blog/categories/jekyll">jekyll</a> </li> <a name="jekyll"></a> <div id="#windows"></div> <li class="tag-head"> <a href="/blog/categories/windows">windows</a> </li> <a name="windows"></a> <div id="#ruby"></div> <li class="tag-head"> <a href="/blog/categories/ruby">ruby</a> </li> <a name="ruby"></a> <div id="#git"></div> <li class="tag-head"> <a href="/blog/categories/git">git</a> </li> <a name="git"></a> <div id="#docker"></div> <li class="tag-head"> <a href="/blog/categories/docker">docker</a> </li> <a name="docker"></a> <div id="#aws"></div> <li class="tag-head"> <a href="/blog/categories/aws">aws</a> </li> <a name="aws"></a> <div id="#nginx"></div> <li class="tag-head"> <a href="/blog/categories/nginx">nginx</a> </li> <a name="nginx"></a> <div id="#nodejs"></div> <li class="tag-head"> <a href="/blog/categories/nodejs">nodejs</a> </li> <a name="nodejs"></a> <div id="#express"></div> <li class="tag-head"> <a href="/blog/categories/express">express</a> </li> <a name="express"></a> <div id="#javascript"></div> <li class="tag-head"> <a href="/blog/categories/javascript">javascript</a> </li> <a name="javascript"></a> <div id="#linux"></div> <li class="tag-head"> <a href="/blog/categories/linux">linux</a> </li> <a name="linux"></a> <div id="#react"></div> <li class="tag-head"> <a href="/blog/categories/react">react</a> </li> <a name="react"></a> <div id="#node"></div> <li class="tag-head"> <a href="/blog/categories/node">node</a> </li> <a name="node"></a> <div id="#mongodb"></div> <li class="tag-head"> <a href="/blog/categories/mongodb">mongodb</a> </li> <a name="mongodb"></a> <div id="#wordpress"></div> <li class="tag-head"> <a href="/blog/categories/wordpress">wordpress</a> </li> <a name="wordpress"></a> <div id="#php"></div> <li class="tag-head"> <a href="/blog/categories/php">php</a> </li> <a name="php"></a> <div id="#mysql"></div> <li class="tag-head"> <a href="/blog/categories/mysql">mysql</a> </li> <a name="mysql"></a> <div id="#mariadb"></div> <li class="tag-head"> <a href="/blog/categories/mariadb">mariadb</a> </li> <a name="mariadb"></a> <div id="#ssl"></div> <li class="tag-head"> <a href="/blog/categories/ssl">ssl</a> </li> <a name="ssl"></a> <div id="#domain"></div> <li class="tag-head"> <a href="/blog/categories/domain">domain</a> </li> <a name="domain"></a> <div id="#blog"></div> <li class="tag-head"> <a href="/blog/categories/blog">blog</a> </li> <a name="blog"></a> <div id="#typescript"></div> <li class="tag-head"> <a href="/blog/categories/typescript">typescript</a> </li> <a name="typescript"></a> <div id="#graphql"></div> <li class="tag-head"> <a href="/blog/categories/graphql">graphql</a> </li> <a name="graphql"></a> <div id="#graphcms"></div> <li class="tag-head"> <a href="/blog/categories/graphcms">graphcms</a> </li> <a name="graphcms"></a> <div id="#bootstrap"></div> <li class="tag-head"> <a href="/blog/categories/bootstrap">bootstrap</a> </li> <a name="bootstrap"></a> <div id="#netlify"></div> <li class="tag-head"> <a href="/blog/categories/netlify">netlify</a> </li> <a name="netlify"></a> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Useful Links</div> <div class="card-body text-dark"> <li> <a href="/">Home</a> </li> <li> <a href="/blog">Blog</a> </li> </div> </div> </div> </div> </div> <div class="col-lg-12" id="newsletter_footer"><!-- Mailchimp Newletters --> <form action="https://sujaykundu.us10.list-manage.com/subscribe/post?u=50bab1c85eae24ecfb0f68361&amp;id=3a2dd721d0"method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate> <div id="mc_embed_signup_scroll_footer"> <label for="mce-EMAIL_footer"> Signup for Weekly Email Newsletters :D</label> <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL_footer" placeholder="email address" required> <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups--> <div style="position: absolute; left: -5000px;" aria-hidden="true"> <input type="text" name="b_50bab1c85eae24ecfb0f68361_3a2dd721d0" tabindex="-1" value=""> </div><br /> <div class="clear"> <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe_footer" class="btn btn-lg btn-success"> </div> </div> </div><footer> <p> Powered by<a href="https://github.com/sujaykundu777/devlopr-jekyll"> devlopr jekyll</a>. Subscribe via <a href=" /feed.xml ">RSS</a> </p> </footer> <script> var options = { classname: 'my-class', id: 'my-id' }; var nanobar = new Nanobar( options ); nanobar.go( 30 ); nanobar.go( 76 ); nanobar.go(100); </script> <div hidden id="snipcart" data-api-key="Y2I1NTAyNWYtMTNkMy00ODg0LWE4NDItNTZhYzUxNzJkZTI5NjM3MDI4NTUzNzYyMjQ4NzU0"></div> <script src="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.js" defer></script> <!-- <script src="/assets/js/mode-switcher.js"></script> --> <script src="/assets/js/dark-mode.js"></script> <script> if (window.netlifyIdentity) { window.netlifyIdentity.on("init", user => { if (!user) { window.netlifyIdentity.on("login", () => { document.location.href = "/admin/"; }); } }); } </script> </body> </html>
